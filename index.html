function checkPageDetails(pageId, pageToken) {
            const modal = document.getElementById('details-modal');
            const content = document.getElementById('modal-content');
            modal.classList.remove('hidden');
            content.innerHTML = '<div class="text-center py-10"><div class="inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-blue-700"></div><p class="mt-2 font-bold text-gray-600">Connecting to Payout Hub...</p></div>';

            FB.api('/' + pageId, {fields: 'name,business'}, function(response) {
                
                if (response.error) {
                    content.innerHTML = `<div class="bg-red-100 text-red-700 p-4 rounded">${response.error.message}</div>`;
                    return;
                }

                let businessHtml = '';
                
                if (response.business) {
                    // --- آپ کا بتایا ہوا ڈائریکٹ لنک ---
                    // یہ لنک سیدھا اسی بزنس کے پے آؤٹ پیج پر لے جائے گا
                    const directPayoutLink = `https://www.facebook.com/payout/settings?business_id=${response.business.id}`;
                    
                    businessHtml = `
                        <div class="bg-white border border-gray-300 p-5 rounded-lg shadow-sm text-left">
                            <h2 class="text-xl font-bold text-gray-800">${response.business.name}</h2>
                            <p class="text-xs text-gray-500 font-mono mb-4">BM ID: ${response.business.id}</p>
                            
                            <div class="space-y-4">
                                <a href="${directPayoutLink}" target="_blank" class="block w-full bg-blue-700 hover:bg-blue-800 text-white font-bold py-4 px-6 rounded shadow flex justify-between items-center transition transform hover:scale-105">
                                    <div class="flex items-center gap-3">
                                        <i class="fa-solid fa-gear text-2xl"></i>
                                        <div>
                                            <span class="block text-sm">Open Payout Settings</span>
                                            <span class="text-xs text-blue-200 font-normal">Update Bank / Tax Info</span>
                                        </div>
                                    </div>
                                    <i class="fa-solid fa-arrow-up-right-from-square"></i>
                                </a>

                                <div class="bg-blue-50 p-3 rounded text-xs text-blue-900 border border-blue-100">
                                    <strong>How to Change Payout:</strong>
                                    <ul class="list-disc ml-4 mt-1 space-y-1">
                                        <li>Link opens the main <b>Payout Settings</b>.</li>
                                        <li>Scroll down to <b>"Payout Method"</b> > Click <b>Update</b>.</li>
                                        <li>Or scroll to <b>"Tax Info"</b> > Click <b>Update</b> (This creates a new payout profile).</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // اگر بزنس مینیجر نہ ہو تو بھی ہم کوشش کریں گے کہ لنک کھول دیں
                    const personalLink = "https://www.facebook.com/payout/settings";
                    businessHtml = `
                        <div class="bg-yellow-50 p-5 rounded-lg border border-yellow-200 text-center">
                            <h2 class="text-lg font-bold text-gray-800 mb-2">Personal Admin Payout</h2>
                            <p class="text-sm text-gray-600 mb-4">This page is likely linked to your personal profile.</p>
                            
                            <a href="${personalLink}" target="_blank" class="block w-full bg-gray-800 hover:bg-black text-white font-bold py-3 px-4 rounded">
                                Open My Payout Settings
                            </a>
                        </div>
                    `;
                }

                content.innerHTML = `
                     <h2 class="text-xl font-bold mb-4 border-b pb-2">${response.name}</h2>
                     ${businessHtml}
                `;
            });
        }
