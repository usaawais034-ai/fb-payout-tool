function checkPageDetails(pageId, pageToken) {
            const modal = document.getElementById('details-modal');
            const content = document.getElementById('modal-content');
            modal.classList.remove('hidden');
            // لوڈنگ کا انداز تھوڑا بہتر کیا ہے
            content.innerHTML = '<div class="text-center py-10"><div class="inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-blue-700"></div><p class="mt-2 font-bold text-gray-600">Accessing Monetization Data...</p></div>';

            FB.api('/' + pageId, {fields: 'name,business'}, function(response) {
                
                if (response.error) {
                    content.innerHTML = `
                        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative">
                            <strong class="font-bold">Error!</strong>
                            <span class="block sm:inline">${response.error.message}</span>
                        </div>`;
                    return;
                }

                let businessHtml = '';
                
                if (response.business) {
                    // --- اہم تبدیلی: اب یہ لنک سیدھا "ارننگ/پے آؤٹ" والے صفحے پر لے جائے گا ---
                    // business_id = بزنس مینیجر
                    // asset_id = آپ کا پیج
                    const payoutLink = `https://business.facebook.com/latest/payouts?business_id=${response.business.id}`;
                    
                    businessHtml = `
                        <div class="bg-blue-50 p-5 rounded-lg border border-blue-200 text-center">
                            <div class="mb-2"><i class="fa-solid fa-sack-dollar text-3xl text-blue-600"></i></div>
                            <p class="text-xs text-blue-600 font-bold uppercase">Payout Authority Found</p>
                            <h2 class="text-xl font-bold text-gray-800 my-2">${response.business.name}</h2>
                            <p class="text-sm font-mono bg-white inline-block px-2 py-1 rounded border shadow-sm mb-4">BM ID: ${response.business.id}</p>
                            
                            <div class="space-y-3">
                                <a href="${payoutLink}" target="_blank" class="w-full block bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded shadow transition transform hover:scale-105 flex justify-center items-center gap-2">
                                    <i class="fa-solid fa-wallet"></i> Open Payouts Dashboard
                                </a>
                                <p class="text-xs text-gray-500">
                                    Clicking this will open the <b>Financial Section</b>. <br>
                                    There you can see "Earning Source" and change the Bank Account.
                                </p>
                            </div>
                        </div>
                    `;
                } else {
                    businessHtml = `
                        <div class="bg-yellow-50 p-5 rounded-lg border border-yellow-200 text-center">
                            <div class="mb-2"><i class="fa-solid fa-lock text-3xl text-yellow-600"></i></div>
                            <h2 class="text-xl font-bold text-gray-800">Restricted / No BM</h2>
                            <p class="text-gray-600 mt-2 text-sm">
                                Either this page has no Payout yet, or you are not the "Financial Admin".
                                <br>To change payout, you must claim this page into a Business Manager first.
                            </p>
                        </div>
                    `;
                }

                content.innerHTML = businessHtml;
            });
        }
